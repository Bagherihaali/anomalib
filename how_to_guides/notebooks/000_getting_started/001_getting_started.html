<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" />

    <link rel="shortcut icon" href="../../../_static/anomalib-favicon.png"/><meta name="generator" content="sphinx-5.3.0, furo 2022.09.29"/>
        <title>Installing Anomalib - Anomalib v0.3.7</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Anomalib v0.3.7</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../../_static/anomalib-icon.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../tutorials/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/training.html">Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/inference.html">Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/export.html">Export &amp; Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/benchmarking.html">Benchmarking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/logging.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/hyperparameter_optimization.html">Hyperparameter Optimization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../index.html">How to Guides</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../train_custom_data.html">Training with Custom Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../adding_a_new_model.html">Adding a New Model to Anomalib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../100_datamodules/101_btech.html">Use BeanTech Dataset via API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../100_datamodules/102_mvtec.html">Use MVTec AD Dataset via API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../100_datamodules/103_folder.html">Use Folder Dataset (for Custom Datasets) via API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../100_datamodules/104_tiling.html">Tiling Large Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../200_models/201_fastflow.html">Train a Model via API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../300_benchmarking/301_benchmarking.html">Short walkthrough on Benchmarking in Anomalib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../300_benchmarking/302_hpo_wandb.html">Walkthrough on Hyperparameter Optimization using Weights and Biases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../400_openvino/nncf.html">int-8 Model Quantization via NNCF</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../reference_guide/index.html">Reference Guide</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../reference_guide/api/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference_guide/api/cli.html">CLI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference_guide/api/config.html">Configuration</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../reference_guide/api/data/index.html">Dataset</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../reference_guide/api/data/btech.html">Btech Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference_guide/api/data/mvtec.html">MVTec Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference_guide/api/data/folder.html">Folder Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference_guide/api/data/utils.html">Utils</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../reference_guide/api/model/index.html">Model</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../reference_guide/api/model/base.html">Base Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference_guide/api/model/dimensionality_reduction.html">Dimensionality Reduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference_guide/api/model/feature_extractors.html">Feature Extractors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference_guide/api/model/filters.html">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference_guide/api/model/layers.html">Layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference_guide/api/model/sampling.html">Sampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference_guide/api/model/stats.html">Stats</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference_guide/api/post_processing.html">Post Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference_guide/api/metrics.html">Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference_guide/api/loggers.html">Loggers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference_guide/api/sweep.html">Sweep</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference_guide/api/callbacks.html">Callbacks</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../reference_guide/algorithms/index.html">Algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference_guide/algorithms/cflow.html">CFlow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference_guide/algorithms/dfkde.html">DFKDE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference_guide/algorithms/dfm.html">DFM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference_guide/algorithms/draem.html">Draem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference_guide/algorithms/fastflow.html">Fast-Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference_guide/algorithms/ganomaly.html">GANomaly</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference_guide/algorithms/padim.html">Padim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference_guide/algorithms/patchcore.html">PatchCore</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference_guide/algorithms/reverse_distillation.html">Reverse Distillation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference_guide/algorithms/stfpm.html">STFPM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../developer_guide/index.html">Developer Guide</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide/getting_started.html">Getting Started with Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide/pre_commit_hooks.html">Pre-commit Hooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide/using_tox.html">Using Tox</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide/developing_on_docker.html">Developing on Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide/developing_on_docker.html#build-the-docker-image">Build the Docker Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide/developing_on_docker.html#run-the-docker-image">Run the Docker Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide/developing_on_docker.html#using-vscode">Using VSCode</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<center><p><img alt="Paris" class="center" src="https://raw.githubusercontent.com/openvinotoolkit/anomalib/main/docs/source/images/logos/anomalib-wide-blue.png" /></p>
</center><center><p>💙 A library for benchmarking, developing and deploying deep learning anomaly detection algorithms</p>
</center><hr class="docutils" />
<blockquote>
<div><p>NOTE: This notebook is originally created by &#64;innat on <a class="reference external" href="https://www.kaggle.com/code/ipythonx/mvtec-ad-anomaly-detection-with-anomalib-library/notebook">Kaggle</a>.</p>
</div></blockquote>
<p><a class="reference external" href="https://github.com/openvinotoolkit/anomalib">Anomalib</a>: Anomalib is a deep learning library that aims to collect state-of-the-art anomaly detection algorithms for benchmarking on both public and private datasets. Anomalib provides several ready-to-use implementations of anomaly detection algorithms described in the recent literature, as well as a set of tools that facilitate the development and implementation of custom models. The library has a strong focus on image-based anomaly detection,
where the goal of the algorithm is to identify anomalous images, or anomalous pixel regions within images in a dataset.</p>
<p>The library supports <code class="docutils literal notranslate"><span class="pre">`MVTec</span> <span class="pre">AD</span></code> &lt;<a class="reference external" href="https://www.mvtec.com/company/research/datasets/mvtec-ad">https://www.mvtec.com/company/research/datasets/mvtec-ad</a>&gt;`__ (CC BY-NC-SA 4.0) and <code class="docutils literal notranslate"><span class="pre">`BeanTech</span></code> &lt;<a class="reference external" href="https://paperswithcode.com/dataset/btad">https://paperswithcode.com/dataset/btad</a>&gt;`__ (CC-BY-SA) for <strong>benchmarking</strong> and <code class="docutils literal notranslate"><span class="pre">folder</span></code> for custom dataset <strong>training/inference</strong>. In this notebook, we will explore <code class="docutils literal notranslate"><span class="pre">anomalib</span></code> training a PADIM model on the <code class="docutils literal notranslate"><span class="pre">MVTec</span> <span class="pre">AD</span></code> bottle dataset and evaluating the model’s performance. The sections in this notebook explores the steps in <code class="docutils literal notranslate"><span class="pre">tools/train.py</span></code> more in detail.
Those who would like to reproduce the results via CLI could use <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">tools/train.py</span> <span class="pre">--model</span> <span class="pre">padim</span></code>.</p>
<section id="Installing-Anomalib">
<h1>Installing Anomalib<a class="headerlink" href="#Installing-Anomalib" title="Permalink to this heading">¶</a></h1>
<p>Installation can be done in two ways: (i) install via PyPI, or (ii) installing from source. In this notebook, we’ll install it from source in order to get the most recent version of anomalib.</p>
<section id="I.-Install-via-PyPI">
<h2>I. Install via PyPI<a class="headerlink" href="#I.-Install-via-PyPI" title="Permalink to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Option - I: Uncomment the next line if you want to install via pip.</span>
<span class="c1"># %pip install anomalib</span>
</pre></div>
</div>
</div>
</section>
<section id="II.-Install-from-Source">
<h2>II. Install from Source<a class="headerlink" href="#II.-Install-from-Source" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>NOTE: If you are running the notebook on Google Colab, make sure that you install the library from source to have access to the entire material, including configuration files, etc.</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Option - II: Uncomment the next three lines if you want to install from the source.</span>
<span class="c1"># %git clone https://github.com/openvinotoolkit/anomalib.git</span>
<span class="c1"># %cd anomalib</span>
<span class="c1"># %pip install -e .</span>
</pre></div>
</div>
</div>
<blockquote>
<div><p>NOTE: If you are running the notebook from the <code class="docutils literal notranslate"><span class="pre">notebooks/000_getting_started</span></code> directory of the repository, you could install the library as follows:</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># If you are in `~/anomalib/notebooks/000_getting_started` directory, uncomment the following two lines.</span>
<span class="c1"># %cd ../..</span>
<span class="c1"># %pip install -e .</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Imports">
<h1>Imports<a class="headerlink" href="#Imports" title="Permalink to this heading">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">pytorch_lightning</span> <span class="kn">import</span> <span class="n">Trainer</span>
<span class="kn">from</span> <span class="nn">torchvision.transforms</span> <span class="kn">import</span> <span class="n">ToPILImage</span>

<span class="kn">from</span> <span class="nn">anomalib.config</span> <span class="kn">import</span> <span class="n">get_configurable_parameters</span>
<span class="kn">from</span> <span class="nn">anomalib.data</span> <span class="kn">import</span> <span class="n">get_datamodule</span>
<span class="kn">from</span> <span class="nn">anomalib.models</span> <span class="kn">import</span> <span class="n">get_model</span>
<span class="kn">from</span> <span class="nn">anomalib.pre_processing.transforms</span> <span class="kn">import</span> <span class="n">Denormalize</span>
<span class="kn">from</span> <span class="nn">anomalib.utils.callbacks</span> <span class="kn">import</span> <span class="n">LoadModelCallback</span><span class="p">,</span> <span class="n">get_callbacks</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/user/conda/lib/python3.8/site-packages/tqdm/auto.py:22: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html
  from .autonotebook import tqdm as notebook_tqdm
</pre></div></div>
</div>
</section>
<section id="Model">
<h1>Model<a class="headerlink" href="#Model" title="Permalink to this heading">¶</a></h1>
<p>Currently, there are <strong>13</strong> anomaly detection models available in <code class="docutils literal notranslate"><span class="pre">anomalib</span></code> library. Namely,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/2206.04325">CFA</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/abs/2110.02855v1">CS-Flow</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/pdf/2107.12571v1.pdf">CFlow</a></p></li>
<li><p><a class="reference external" href="https://github.com/openvinotoolkit/anomalib/tree/main/anomalib/models/dfkde">DFKDE</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/pdf/1909.11786.pdf">DFM</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/abs/2108.07610">DRAEM</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/abs/2111.07677">FastFlow</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/abs/1805.06725">Ganomaly</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/pdf/2011.08785.pdf">Padim</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/pdf/2106.08265.pdf">Patchcore</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/abs/2201.10703">Reverse Distillation</a></p></li>
<li><p><a class="reference external" href="https://ieeexplore.ieee.org/document/8999287">R-KDE</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/pdf/2103.04257.pdf">STFPM</a></p></li>
</ul>
<p>In this tutorial, we’ll be using Padim. Now, let’s get their config paths from the respected folders.</p>
</section>
<section id="Configuration">
<h1>Configuration<a class="headerlink" href="#Configuration" title="Permalink to this heading">¶</a></h1>
<p>In this demonstration, we will choose <a class="reference external" href="https://arxiv.org/pdf/2011.08785.pdf">Padim</a> model from the above list. Let’s take a quick look at its config file.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MODEL</span> <span class="o">=</span> <span class="s2">&quot;padim&quot;</span>  <span class="c1"># &#39;padim&#39;, &#39;cflow&#39;, &#39;stfpm&#39;, &#39;ganomaly&#39;, &#39;dfkde&#39;, &#39;patchcore&#39;</span>
<span class="n">CONFIG_PATH</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;../../anomalib/models/</span><span class="si">{</span><span class="n">MODEL</span><span class="si">}</span><span class="s2">/config.yaml&quot;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">CONFIG_PATH</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dataset:
  name: mvtec
  format: mvtec
  path: ./datasets/MVTec
  category: bottle
  task: segmentation
  train_batch_size: 32
  eval_batch_size: 32
  num_workers: 8
  image_size: 256 # dimensions to which images are resized (mandatory)
  center_crop: null # dimensions to which images are center-cropped after resizing (optional)
  normalization: imagenet # data distribution to which the images will be normalized: [none, imagenet]
  transform_config:
    train: null
    eval: null
  test_split_mode: from_dir # options: [from_dir, synthetic]
  test_split_ratio: 0.2 # fraction of train images held out testing (usage depends on test_split_mode)
  val_split_mode: same_as_test # options: [same_as_test, from_test, synthetic]
  val_split_ratio: 0.5 # fraction of train/test images held out for validation (usage depends on val_split_mode)
  tiling:
    apply: false
    tile_size: null
    stride: null
    remove_border_count: 0
    use_random_tiling: False
    random_tile_count: 16

model:
  name: padim
  backbone: resnet18
  pre_trained: true
  layers:
    - layer1
    - layer2
    - layer3
  normalization_method: min_max # options: [none, min_max, cdf]

metrics:
  image:
    - F1Score
    - AUROC
  pixel:
    - F1Score
    - AUROC
  threshold:
    method: adaptive #options: [adaptive, manual]
    manual_image: null
    manual_pixel: null

visualization:
  show_images: False # show images on the screen
  save_images: True # save images to the file system
  log_images: True # log images to the available loggers (if any)
  image_save_path: null # path to which images will be saved
  mode: full # options: [&#34;full&#34;, &#34;simple&#34;]

project:
  seed: 42
  path: ./results

logging:
  logger: [] # options: [comet, tensorboard, wandb, csv] or combinations.
  log_graph: false # Logs the model graph to respective logger.

optimization:
  export_mode: null #options: onnx, openvino

# PL Trainer Args. Don&#39;t add extra parameter here.
trainer:
  accelerator: auto # &lt;&#34;cpu&#34;, &#34;gpu&#34;, &#34;tpu&#34;, &#34;ipu&#34;, &#34;hpu&#34;, &#34;auto&#34;&gt;
  accumulate_grad_batches: 1
  amp_backend: native
  auto_lr_find: false
  auto_scale_batch_size: false
  auto_select_gpus: false
  benchmark: false
  check_val_every_n_epoch: 1 # Don&#39;t validate before extracting features.
  default_root_dir: null
  detect_anomaly: false
  deterministic: false
  devices: 1
  enable_checkpointing: true
  enable_model_summary: true
  enable_progress_bar: true
  fast_dev_run: false
  gpus: null # Set automatically
  gradient_clip_val: 0
  ipus: null
  limit_predict_batches: 1.0
  limit_test_batches: 1.0
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  log_every_n_steps: 50
  max_epochs: 1
  max_steps: -1
  max_time: null
  min_epochs: null
  min_steps: null
  move_metrics_to_cpu: false
  multiple_trainloader_mode: max_size_cycle
  num_nodes: 1
  num_processes: null
  num_sanity_val_steps: 0
  overfit_batches: 0.0
  plugins: null
  precision: 32
  profiler: null
  reload_dataloaders_every_n_epochs: 0
  replace_sampler_ddp: true
  sync_batchnorm: false
  tpu_cores: null
  track_grad_norm: -1
  val_check_interval: 1.0 # Don&#39;t validate before extracting features.

</pre></div></div>
</div>
<p>We could use <a class="reference external" href="https://github.com/openvinotoolkit/anomalib/blob/main/anomalib/config/config.py#L114">get_configurable_parameter</a> function to read the configs from the path and return them in a dictionary. We use the default config file that comes with Padim implementation, which uses <code class="docutils literal notranslate"><span class="pre">./datasets/MVTec</span></code> as the path to the dataset. We need to overwrite this after loading the config.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pass the config file to model, callbacks and datamodule</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">get_configurable_parameters</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="n">CONFIG_PATH</span><span class="p">)</span>
<span class="n">config</span><span class="p">[</span><span class="s2">&quot;dataset&quot;</span><span class="p">][</span><span class="s2">&quot;path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;../../datasets/MVTec&quot;</span>  <span class="c1"># or wherever the MVTec dataset is stored.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/user/conda/lib/python3.8/site-packages/anomalib/config/config.py:275: UserWarning: config.project.unique_dir is set to False. This does not ensure that your results will be written in an empty directory and you may overwrite files.
  warn(
</pre></div></div>
</div>
</section>
<section id="Dataset:-MVTec-AD">
<h1>Dataset: MVTec AD<a class="headerlink" href="#Dataset:-MVTec-AD" title="Permalink to this heading">¶</a></h1>
<p><strong>MVTec AD</strong> is a dataset for benchmarking anomaly detection methods with a focus on industrial inspection. It contains over <strong>5000</strong> high-resolution images divided into <strong>15</strong> different object and texture categories. Each category comprises a set of defect-free training images and a test set of images with various kinds of defects as well as images without defects. If the dataset is not located in the root datasets directory, anomalib will automatically install the dataset.</p>
<p>We could now import the MVtec AD dataset using its specific datamodule implemented in anomalib.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datamodule</span> <span class="o">=</span> <span class="n">get_datamodule</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="n">datamodule</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>  <span class="c1"># Downloads the dataset if it&#39;s not in the specified `root` directory</span>
<span class="n">datamodule</span><span class="o">.</span><span class="n">prepare_data</span><span class="p">()</span>  <span class="c1"># Create train/val/test/prediction sets.</span>

<span class="n">i</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">datamodule</span><span class="o">.</span><span class="n">val_dataloader</span><span class="p">()))</span>
<span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([&#39;image_path&#39;, &#39;label&#39;, &#39;image&#39;, &#39;mask_path&#39;, &#39;mask&#39;])
</pre></div></div>
</div>
<p>Let’s check the shapes of the input images and masks.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;mask&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
torch.Size([32, 3, 256, 256]) torch.Size([32, 256, 256])
</pre></div></div>
</div>
<p>We could now visualize a normal and abnormal sample from the validation set.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">show_image_and_mask</span><span class="p">(</span><span class="n">sample</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Image</span><span class="p">:</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">ToPILImage</span><span class="p">()(</span><span class="n">Denormalize</span><span class="p">()(</span><span class="n">sample</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">clone</span><span class="p">()))</span>
    <span class="n">msk</span> <span class="o">=</span> <span class="n">ToPILImage</span><span class="p">()(</span><span class="n">sample</span><span class="p">[</span><span class="s2">&quot;mask&quot;</span><span class="p">][</span><span class="n">index</span><span class="p">])</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">msk</span><span class="p">))))</span>


<span class="c1"># Visualize a normal image-mask</span>
<span class="n">show_image_and_mask</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/user/conda/lib/python3.8/site-packages/anomalib/pre_processing/transforms/custom.py:24: UserWarning: Denormalize is no longer used and will be deprecated in v0.4.0
  warnings.warn(&#34;Denormalize is no longer used and will be deprecated in v0.4.0&#34;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_21_1.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_21_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize an abnormal image-mask</span>
<span class="n">show_image_and_mask</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_22_0.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_22_0.png" />
</div>
</div>
</section>
<section id="Prepare-Model-and-Callbacks">
<h1>Prepare Model and Callbacks<a class="headerlink" href="#Prepare-Model-and-Callbacks" title="Permalink to this heading">¶</a></h1>
<p>Now, the config file is updated as we want. We can now start model training with it. Here we will be using <code class="docutils literal notranslate"><span class="pre">datamodule</span></code>, <code class="docutils literal notranslate"><span class="pre">model</span></code> and <code class="docutils literal notranslate"><span class="pre">callbacks</span></code> to train the model. Callbacks are self-contained objects, which contains non-essential logic. This way we could inject as many callbacks as possible such as ModelLoading, Timer, Metrics, Normalization and Visualization</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">get_model</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="n">callbacks</span> <span class="o">=</span> <span class="n">get_callbacks</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/user/conda/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: DeprecationWarning: From v0.10 an `&#39;Binary*&#39;`, `&#39;Multiclass*&#39;, `&#39;Multilabel*&#39;` version now exist of each classification metric. Moving forward we recommend using these versions. This base metric will still work as it did prior to v0.10 until v0.11. From v0.11 the `task` argument introduced in this metric will be required and the general order of arguments may change, such that this metric will just function as an single entrypoint to calling the three specialized versions.
  warnings.warn(*args, **kwargs)
/home/user/conda/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `PrecisionRecallCurve` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
FeatureExtractor is deprecated. Use TimmFeatureExtractor instead. Both FeatureExtractor and TimmFeatureExtractor will be removed in version 2023.1
/home/user/conda/lib/python3.8/site-packages/anomalib/utils/callbacks/__init__.py:142: UserWarning: Export option: None not found. Defaulting to no model export
  warnings.warn(f&#34;Export option: {config.optimization.export_mode} not found. Defaulting to no model export&#34;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># start training</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="o">.</span><span class="n">trainer</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">datamodule</span><span class="o">=</span><span class="n">datamodule</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
`Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
`Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
`Trainer(limit_predict_batches=1.0)` was configured so 100% of the batches will be used..
`Trainer(val_check_interval=1.0)` was configured so validation will run at the end of the training epoch..
Missing logger folder: results/padim/mvtec/bottle/run/lightning_logs
/home/user/conda/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `ROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
/home/user/conda/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py:183: UserWarning: `LightningModule.configure_optimizers` returned `None`, this fit will run with no optimizer
  rank_zero_warn(

  | Name                  | Type                     | Params
-------------------------------------------------------------------
0 | image_threshold       | AnomalyScoreThreshold    | 0
1 | pixel_threshold       | AnomalyScoreThreshold    | 0
2 | model                 | PadimModel               | 2.8 M
3 | image_metrics         | AnomalibMetricCollection | 0
4 | pixel_metrics         | AnomalibMetricCollection | 0
5 | normalization_metrics | MinMax                   | 0
-------------------------------------------------------------------
2.8 M     Trainable params
0         Non-trainable params
2.8 M     Total params
11.131    Total estimated model params size (MB)
/home/user/conda/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py:1933: PossibleUserWarning: The number of training batches (7) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
  rank_zero_warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 0:  40%|████      | 4/10 [00:01&lt;00:02,  2.18it/s, loss=nan, v_num=0]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/user/conda/lib/python3.8/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py:137: UserWarning: `training_step` returned `None`. If this was on purpose, ignore this warning...
  self.warning_cache.warn(&#34;`training_step` returned `None`. If this was on purpose, ignore this warning...&#34;)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 0:  70%|███████   | 7/10 [00:02&lt;00:00,  3.50it/s, loss=nan, v_num=0]
Validation: 0it [00:00, ?it/s]
Validation:   0%|          | 0/3 [00:00&lt;?, ?it/s]
Validation DataLoader 0:   0%|          | 0/3 [00:00&lt;?, ?it/s]
Validation DataLoader 0:  33%|███▎      | 1/3 [00:00&lt;00:00,  8.63it/s]
Epoch 0:  80%|████████  | 8/10 [00:08&lt;00:02,  1.01s/it, loss=nan, v_num=0]
Validation DataLoader 0:  67%|██████▋   | 2/3 [00:00&lt;00:00,  8.59it/s]
Epoch 0:  90%|█████████ | 9/10 [00:08&lt;00:00,  1.10it/s, loss=nan, v_num=0]
Epoch 0: 100%|██████████| 10/10 [00:08&lt;00:00,  1.11it/s, loss=nan, v_num=0, pixel_F1Score=0.716, pixel_AUROC=0.982]
Epoch 0: 100%|██████████| 10/10 [00:08&lt;00:00,  1.11it/s, loss=nan, v_num=0, pixel_F1Score=0.716, pixel_AUROC=0.982]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/user/conda/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: DeprecationWarning: `torchmetrics.functional.auc` has been move to `torchmetrics.utilities.compute` in v0.10 and will be removed in v0.11.
  warnings.warn(*args, **kwargs)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 0: 100%|██████████| 10/10 [00:09&lt;00:00,  1.06it/s, loss=nan, v_num=0, pixel_F1Score=0.716, pixel_AUROC=0.982]
</pre></div></div>
</div>
</section>
<section id="Validation">
<h1>Validation<a class="headerlink" href="#Validation" title="Permalink to this heading">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load best model from checkpoint before evaluating</span>
<span class="n">load_model_callback</span> <span class="o">=</span> <span class="n">LoadModelCallback</span><span class="p">(</span><span class="n">weights_path</span><span class="o">=</span><span class="n">trainer</span><span class="o">.</span><span class="n">checkpoint_callback</span><span class="o">.</span><span class="n">best_model_path</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">load_model_callback</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">datamodule</span><span class="o">=</span><span class="n">datamodule</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Testing DataLoader 0: 100%|██████████| 3/3 [00:19&lt;00:00,  6.60s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       Test metric             DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       image_AUROC          0.9944444894790649
      image_F1Score              0.984375
       pixel_AUROC          0.9819654226303101
      pixel_F1Score         0.7155288457870483
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[{&#39;pixel_F1Score&#39;: 0.7155288457870483,
  &#39;pixel_AUROC&#39;: 0.9819654226303101,
  &#39;image_F1Score&#39;: 0.984375,
  &#39;image_AUROC&#39;: 0.9944444894790649}]
</pre></div></div>
</div>
<p>By default, the output images are saved into <code class="docutils literal notranslate"><span class="pre">results</span></code> directory. We could get the output filenames from the directory, read the saved the images and visualize here.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">][</span><span class="s2">&quot;path&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
results/padim/mvtec/bottle/run
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image_filenames</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">][</span><span class="s2">&quot;path&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;**/*.png&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">image_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
results/padim/mvtec/bottle/run/images/image_ROC.png
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">image_filenames</span><span class="p">:</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_0.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_1.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_2.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_3.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_4.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_5.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_6.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_6.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_7.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_7.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_8.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_8.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_9.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_9.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_10.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_10.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_11.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_11.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_12.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_12.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_13.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_13.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_14.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_14.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_15.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_15.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_16.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_16.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_17.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_17.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_18.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_18.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_19.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_19.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_20.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_20.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_21.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_21.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_22.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_22.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_23.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_23.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_24.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_24.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_25.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_25.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_26.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_26.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_27.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_27.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_28.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_28.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_29.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_29.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_30.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_30.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_31.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_31.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_32.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_32.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_33.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_33.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_34.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_34.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_35.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_35.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_36.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_36.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_37.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_37.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_38.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_38.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_39.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_39.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_40.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_40.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_41.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_41.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_42.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_42.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_43.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_43.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_44.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_44.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_45.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_45.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_46.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_46.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_47.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_47.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_48.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_48.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_49.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_49.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_50.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_50.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_51.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_51.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_52.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_52.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_53.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_53.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_54.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_54.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_55.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_55.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_56.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_56.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_57.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_57.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_58.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_58.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_59.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_59.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_60.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_60.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_61.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_61.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_62.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_62.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_63.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_63.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_64.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_64.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_65.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_65.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_66.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_66.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_67.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_67.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_68.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_68.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_69.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_69.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_70.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_70.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_71.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_71.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_72.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_72.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_73.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_73.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_74.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_74.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_75.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_75.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_76.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_76.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_77.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_77.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_78.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_78.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_79.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_79.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_80.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_80.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_81.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_81.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_82.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_82.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_83.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_83.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_84.png" src="../../../_images/how_to_guides_notebooks_000_getting_started_001_getting_started_31_84.png" />
</div>
</div>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Installing Anomalib</a><ul>
<li><a class="reference internal" href="#I.-Install-via-PyPI">I. Install via PyPI</a></li>
<li><a class="reference internal" href="#II.-Install-from-Source">II. Install from Source</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Imports">Imports</a></li>
<li><a class="reference internal" href="#Model">Model</a></li>
<li><a class="reference internal" href="#Configuration">Configuration</a></li>
<li><a class="reference internal" href="#Dataset:-MVTec-AD">Dataset: MVTec AD</a></li>
<li><a class="reference internal" href="#Prepare-Model-and-Callbacks">Prepare Model and Callbacks</a></li>
<li><a class="reference internal" href="#Validation">Validation</a></li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>